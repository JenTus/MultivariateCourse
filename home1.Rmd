---
title: "Homework1"
output: github_document
---

## Q1

Create an R-function that takes a data matrix $X \in \mathbb{R}^{n\times p}, n> p$, as an
argument and returns the unbiased estimator of the covariance matrix. Do
not use the built-in functions cov(), cor() or any additional R-packages.

## Code of Q1


```{r}

D1 <- as.matrix(read.table("data/Data1.txt", sep = "\t", header = F))

covariance <- function(x){
  ave <- apply(x, 2, mean)
  cent <- sweep(x, 2, ave, "-")
  cova <- t(cent) %*% cent / (dim(x)[1]-1)
  return(cova)
}

D1.cov <- covariance(D1)
```

## Q2

Create an R-function that takes a full-rank covariance matrix $A \in \mathbb{R}^{p\times p}$ as
an argument and returns the square root of the inverse matrix such that $A^{-\frac{1}{2}}A^{-\frac{1}{2}} = A^{-}$

## Code of Q2

```{r}
trans_square_root <- function(x){
  lam <- eigen(x)$values
  gam <- eigen(x)$vectors
  
  eigen_value <- sqrt(solve(diag(lam)))
  
  return(gam %*% eigen_value %*% t(gam))
}

trans_square_root(D1.cov)
```

## Q3

Create an R-function that takes a full-rank covariance matrix A as an argument and returns the corresponding correlation matrix.

## Code of Q3

```{r}
correlation <- function(x){
  x.diag <- diag(diag(x))
  
  corr <- sqrt(solve(x.diag)) %*% x %*% sqrt(solve(x.diag))
  
  return(corr)
}

correlation(D1.cov)
cor(D1)
```

