---
title: "Multiple Correspondence Analysis"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Find a combination of two MCA components that explain as much of the
variation as possible. What is the combination and how much of the total
variation is explained by these two components?

```{r}
library("ca")
library("ggplot2")
tb <- read.table("data/WG93_full.txt", header = T, row.names = 1)
head(tb)
# View(tb)

# univariate analysis
par(mfrow = c(3,3))
for(i in 1:dim(tb)[2]){
  tmp <- table(tb[,i])
  lab <- round(100*tmp/sum(tmp),1)
  pielabels <- paste(lab,"%",sep="")
  cols <- c("black","grey","green","red", "yellow", "brown")
  title <- names(tb)[i]
  pie(tmp, main=title,col=cols,labels=pielabels,cex=0.8)
  
  legend("topleft",names(lab),fill=cols,horiz=F,cex=0.5)
}


# multivariate analysis
tb.mca <- mjca(tb, lambda = "indicator")
names(tb.mca)
summary(tb.mca)
# first two principle components
(tb.mca$sv[1]^2 + tb.mca$sv[2]^2) / sum(tb.mca$sv^2)
```


Produce the MCA graph with respect to the components chosen in (a).

```{r}
# plot
# data frame for ggplot
tb_mca_df = data.frame(tb.mca$colcoord, Variable = rep(names(tb.mca$levels.n), tb.mca$levels.n))
rownames(tb_mca_df) = tb.mca$levelnames

# plot
xx = round(tb.mca$sv[1]^2/sum(tb.mca$sv^2)*100, 2)
yy = round(tb.mca$sv[2]^2/sum(tb.mca$sv^2)*100, 2)
ggplot(data = tb_mca_df, 
       aes(x = X1, y = X2, label = rownames(tb_mca_df))) +
  geom_hline(yintercept = 0, colour = "gray70") +
  geom_vline(xintercept = 0, colour = "gray70") +
  geom_text(aes(colour = Variable)) +
  geom_segment(mapping=aes(x=0, y=0, xend=X1, yend=X2, colour = Variable), arrow=arrow(length=unit(0.2,"cm")), size=0.3) + 
  labs(x = paste("pca1 = ", xx,"%",sep=""), y = paste("pca2 = ", yy,"%",sep="")) 
  # ggtitle("MCA plot of variables using R package ca")
dev.off()
```

What is the relationship between education and strong opinions (strongly
agree/strongly disagree) in this data set? Justify!

```{r}
# question 3
questions = c("A", "B", "C", "D")
par(mfrow=c(2,2))
for(i in 1 : length(questions)){
  tbb <- tb[, which(names(tb) == "edu" | names(tb) == questions[i])]
  tmp <- table(tbb)
  tmp.ca <- ca(tmp)
  plot(tmp.ca, arrows = c(T, T), what = c("all", "all"))
  legend("topleft", names(tbb), fill = c("blue", "red"), horiz=F, cex=0.5)
}
dev.off()
```
